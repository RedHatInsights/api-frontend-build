(self.webpackChunkinsights_frontend_starter_app=self.webpackChunkinsights_frontend_starter_app||[]).push([[474],{61171:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>ee});var r=n(67154),o=n.n(r),i=n(59713),a=n.n(i),l=n(319),c=n.n(l),s=n(63038),u=n.n(s),p=n(80150),f=n.n(p),d=n(45697),m=n.n(d),v=n(14224),b=n(89583),g=n(62851),h=n(29515),O=n(47835),w=n(56500),y=n(13877),P=n(34538),E=n(70983),j=n(4250),S=n(6479),N=n.n(S),C=n(7174),D=n(8896),T=n(6202),I=n(219),k=n(34348),A=n(74183),L=n(47194),R=n(12491),B=n(1657),_=n(83958),F=n(35823),x=n.n(F),W=n(66085),z=n.n(W),J=n(85564),V=n.n(J);function H(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Q(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?H(Object(n),!0).forEach((function(t){a()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):H(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var U=["","title","appName","version"],q=function(e){return[{title:"Application name",transforms:[P.sortable],cellTransforms:[(0,w.treeTable)(e)]},{title:"API endpoint",transforms:[P.nowrap,P.sortable,(0,P.cellWidth)(10)]},{title:"API version",transforms:[P.nowrap,P.sortable,(0,P.cellWidth)(10)]},{title:"Download",transforms:[(0,P.cellWidth)(10)]}]},G=function(e,t,n){var r,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],i=arguments.length>4?arguments[4]:void 0;return{selected:null==o||null===(r=o[t])||void 0===r?void 0:r.isSelected,cells:[{title:f().createElement(p.Fragment,null,n?f().createElement(L.Link,{to:"/".concat(i).concat("v1"!==n?"/".concat(n):"")},e):e),value:e,props:{value:e,"data-position":"title"}},n?"/api/".concat(i):"",{title:f().createElement(C.Badge,null,n),value:n},{title:f().createElement(T.Button,{variant:"plain",onClick:function(){return M(i,n)}}," ",f().createElement(B.default,null)," ")}]}},K=[{cells:[{title:f().createElement(R.o,null,f().createElement(D.b,null,f().createElement(I.ub,{variant:I.IQ.full},f().createElement(k.Title,{headingLevel:"h5",size:"lg"},"No matching rules found"),f().createElement(A.B,null,"This filter criteria matches no rules. ",f().createElement("br",null)," Try changing your filter settings.")))),props:{colSpan:4}}]}];function M(e,t){(0,_.w0)({name:e,version:t}).then((function(t){delete t.latest,delete t.name,x()(JSON.stringify(t),"".concat(e,"-openapi.json"))}))}var X=n(90017);function Y(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Z(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Y(Object(n),!0).forEach((function(t){a()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Y(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var $=function(e){var t=e.loadApis,n=e.services,r=e.selectRow,i=e.onError;(0,p.useEffect)((function(){t()}),[]);var a,l,s=(0,p.useState)([]),d=u()(s,2),m=d[0],E=d[1],j=(0,p.useState)({}),S=u()(j,2),C=S[0],D=S[1],T=(0,p.useState)({perPage:50,page:1}),I=u()(T,2),k=I[0],A=I[1],L=(0,p.useState)(""),R=u()(L,2),B=R[0],F=R[1],W=B&&n.endpoints.filter((function(e){return function(e,t){var n,r,o,i,a,l=[null===(n=e.frontend)||void 0===n?void 0:n.title].concat(c()((null===(r=e.frontend)||void 0===r?void 0:r.paths)||[]),c()((null===(o=e.frontend)||void 0===o||null===(i=o.sub_apps)||void 0===i?void 0:i.reduce((function(e,t){return[].concat(c()(e),[t.title,t.id])}),[]))||[]),[null===(a=e.api)||void 0===a?void 0:a.apiName]).filter(Boolean);return U.some((function(n){return e[n]&&-1!==e[n].toLocaleLowerCase().indexOf(t.toLocaleLowerCase())}))||l.some((function(e){return-1!==e.toLocaleLowerCase().indexOf(t.toLocaleLowerCase())}))}(e,B)})),J=n.loaded?function(e,t,n,r,o){var i=t.page,a=t.perPage;return n.length>0?n.sort((function(t,n){return function(e,t){var n,r,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"title",i=function(e){return"appName"===o&&e.apiName?"apiName":o};return(arguments.length>3?arguments[3]:void 0)?null===(n=t[i(t)])||void 0===n?void 0:n.localeCompare(e[i(e)],"en",{sensitivity:"base"}):null===(r=e[i(e)])||void 0===r?void 0:r.localeCompare(t[i(t)],"en",{sensitivity:"base"})}(t,n,U[e.index],e.direction===P.SortByDirection.desc)})).slice((i-1)*a,i*a).map((function(e,t){var n,i=e.frontend,a=e.title,l=e.appName,s=e.version,p=e.apiName,f=e.api;return[Q(Q(Q({},G(a,"".concat(f.subItems?"parent-":"").concat(p||l),s,r,p||l)),f.subItems&&{isTreeOpen:null==o||null===(n=o.includes)||void 0===n?void 0:n.call(o,i&&i.title||a),subItems:f.subItems}),{},{noDetail:!s})].concat(c()(f.subItems?Object.entries(f.subItems).map((function(e){var n=u()(e,2),o=n[0],i=n[1],a=i.title,l=i.versions,c=i.apiName;return Q(Q({},G(a,c||o,null==l?void 0:l[0],r,c||o)),{},{treeParent:t})})):[]))})).flat():K}(C,k,W||n.endpoints,n.selectedRows,m):[];return f().createElement(f().Fragment,null,f().createElement(v.mr,{className:"pf-m-light"},f().createElement(v.BV,{title:"API documentation"})),f().createElement(b.o,{className:"ins-c-docs__api"},f().createElement(f().Fragment,null,f().createElement(O.U,o()({filterConfig:{items:[{label:"Filter by application name",type:"text",filterValues:{id:"filter-by-string",key:"filter-by-string",placeholder:"Filter by application name",value:B,onChange:function(e,t){A(Z(Z({},k),{},{page:1})),F(t)},isDisabled:!n.loaded}}]},actionsConfig:{actions:[{label:"Download selected",props:{isDisabled:(a=n,l=a.selectedRows,!l||0===Object.values(l||{}).map((function(e){return e.isSelected})).filter(Boolean).length),onClick:function(){return function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,n=new(z()),r=Object.values(e).filter((function(e){return e.isSelected})).map((function(e){var n=e.appName,r=e.version,o=e.apiName,i=e.subItems;return i?Object.entries(i).map((function(e){var n=u()(e,2),r=n[0],o=n[1].versions;return(0,_.w0)({name:r,version:o[0]}).catch((function(){return t("API ".concat(r," with version ").concat(o[0]," not found or broken."))}))})):(0,_.w0)({name:o||n,version:r}).catch((function(){return t("API ".concat(o||n," with version ").concat(r," not found or broken."))}))}));Promise.all(V()(r)).then((function(e){if(e&&e.length>1)e.map((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.name,r=N()(e,["name"]);t&&(delete r.latest,n.file("".concat(t,"-openapi.json"),JSON.stringify(r)))})),n.generateAsync({type:"blob"}).then((function(e){return x()(e,"cloud-services-openapi.zip")}));else if(e&&1===e.length){var t=e[0]||{},r=t.name,o=N()(t,["name"]);r&&(delete o.latest,x()(JSON.stringify(o),"".concat(r,"-openapi.json")))}}))}(n.selectedRows,i)}}}]}},n.loaded&&{pagination:Z(Z({},k),{},{itemCount:(W||n.endpoints).length,onSetPage:function(e,t){return A(Z(Z({},k),{},{page:t}))},onPerPageSelect:function(e,t){return A(Z(Z({},k),{},{perPage:t}))}})},B.length>0&&{activeFiltersConfig:{filters:[{name:B}],onDelete:function(){A(Z(Z({},k),{},{page:1})),F("")}}})),n.loaded?f().createElement(P.Table,o()({className:"pf-m-expandable pf-c-treeview","aria-label":"Sortable Table",variant:P.TableVariant.compact,sortBy:C,onSort:function(e,t,n){return D({index:t,direction:n})},cells:q((function(e,t){var n=t.props.value;m.includes(n)?E((function(){return m.filter((function(e){return e!==n}))})):E((function(){return[].concat(c()(m),[n])}))})),rows:(0,w.sizeCalculator)(J),rowWrapper:w.TreeRowWrapper},(W||n.endpoints).length>0&&{onSelect:function(e,t,n){r(t,-1===n?J:J[n])}}),f().createElement(P.TableHeader,null),f().createElement(P.TableBody,null)):f().createElement(g.c,{columns:q,rowSize:28})),f().createElement(h.f,{isFooter:!0},n.loaded?f().createElement(y.Pagination,{variant:"bottom",dropDirection:"up",itemCount:(W||n.endpoints).length,perPage:k.perPage,page:k.page,onSetPage:function(e,t){return A(Z(Z({},k),{},{page:t}))},onPerPageSelect:function(e,t){return A(Z(Z({},k),{},{perPage:t}))}}):"loading")))};$.propTypes={loadApis:m().func,onError:m().func,services:m().shape({loaded:m().bool,selectedRows:m().shape({isSelected:m().bool}),endpoints:m().arrayOf(m().shape(a()({},m().string,m().oneOfType([m().string,m().number,m().bool,m().node]))))}),history:m().shape({push:m().func}),selectRow:m().func},$.defaultProps={loadApis:function(){},selectRow:function(){},onError:function(){},services:{loaded:!1,selectedRows:{}}};const ee=(0,E.connect)((function(e){return{services:e.services}}),(function(e){return{loadApis:function(){return e((0,j.j3)())},selectRow:function(t,n){return e((0,j.wS)({isSelected:t,row:n}))},onError:function(t){return e((0,X.addNotification)({variant:"danger",title:"Server error",description:t,dismissable:!0}))}}}))($)}}]);
//# sourceMappingURL=Overview.cdf995a261f0230ca0c3.js.map