"use strict";(self.webpackChunkinsights_frontend_starter_app=self.webpackChunkinsights_frontend_starter_app||[]).push([[474],{63947:(e,t,n)=>{n.r(t),n.d(t,{default:()=>M});var r=n(87462),o=n(4942),a=n(93433),i=n(29439),l=n(92950),c=n.n(l),s=n(45697),u=n.n(s),p=n(48716),f=n(39173),d=n(86350),m=n(75959),v=n(32875),g=n(66031),b=n(81557),h=n(79863),y=n(84669),O=n(75795),w=n(44745),P=n(94778),E=n(45987),S=n(86235),j=n(92223),Z=n(1657),N=n(66702),C=n(35823),D=n.n(C),k=n(55733),I=n.n(k),T=n(85564),A=n.n(T),L=n(77515),B=["name"],R=["name"];function _(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function F(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?_(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):_(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var x=["","title","appName","version"],W=function(e){return[{title:"Application name",transforms:[O.sortable],cellTransforms:[(0,L.Z)(e)]},{title:"API endpoint",transforms:[O.nowrap,O.sortable,(0,O.cellWidth)(10)]},{title:"API version",transforms:[O.nowrap,O.sortable,(0,O.cellWidth)(10)]},{title:"Download",transforms:[(0,O.cellWidth)(10)]}]},z=function(e,t,n){var r,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],a=arguments.length>4?arguments[4]:void 0;return{selected:null==o||null===(r=o[t])||void 0===r?void 0:r.isSelected,cells:[{title:c().createElement(l.Fragment,null,n?c().createElement(S.Link,{to:"/".concat(a).concat("v1"!==n[0]?"/".concat(a,"/").concat(n[0]):"")},e):e),value:e,props:{value:e,"data-position":"title"}},n?"/api/".concat(a):"",{title:c().createElement(l.Fragment,null,n&&n.map((function(e){return c().createElement(S.Link,{key:e,to:"/".concat(a,"/").concat(e)},c().createElement(y.Badge,null,e))}))),value:n},{title:c().createElement(y.Button,{variant:"plain",onClick:function(){return V(a,n&&n[0])}}," ",c().createElement(Z.ZP,null)," ")}]}},J=[{cells:[{title:c().createElement(j.Z,null,c().createElement(y.Bullseye,null,c().createElement(y.EmptyState,{variant:y.EmptyStateVariant.full},c().createElement(y.Title,{headingLevel:"h5",size:"lg"},"No matching rules found"),c().createElement(y.EmptyStateBody,null,"This filter criteria matches no rules. ",c().createElement("br",null)," Try changing your filter settings.")))),props:{colSpan:4}}]}];function V(e,t){(0,N.w0)({name:e,version:t}).then((function(t){delete t.latest,delete t.name,D()(JSON.stringify(t),"".concat(e,"-openapi.json"))}))}var H=n(83215);function q(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function G(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?q(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):q(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var K=function(e){var t=e.loadApis,n=e.services,o=e.selectRow,s=e.onError;(0,l.useEffect)((function(){t()}),[]);var u,w,P=(0,l.useState)([]),S=(0,i.Z)(P,2),j=S[0],Z=S[1],C=(0,l.useState)({}),k=(0,i.Z)(C,2),T=k[0],L=k[1],_=(0,l.useState)({perPage:50,page:1}),V=(0,i.Z)(_,2),H=V[0],q=V[1],K=(0,l.useState)(""),M=(0,i.Z)(K,2),Q=M[0],U=M[1],X=Q&&n.endpoints.filter((function(e){return function(e,t){var n,r,o,i,l,c=[null===(n=e.frontend)||void 0===n?void 0:n.title].concat((0,a.Z)((null===(r=e.frontend)||void 0===r?void 0:r.paths)||[]),(0,a.Z)((null===(o=e.frontend)||void 0===o||null===(i=o.sub_apps)||void 0===i?void 0:i.reduce((function(e,t){return[].concat((0,a.Z)(e),[t.title,t.id])}),[]))||[]),[null===(l=e.api)||void 0===l?void 0:l.apiName]).filter(Boolean);return x.some((function(n){return e[n]&&-1!==e[n].toLocaleLowerCase().indexOf(t.toLocaleLowerCase())}))||c.some((function(e){return-1!==e.toLocaleLowerCase().indexOf(t.toLocaleLowerCase())}))}(e,Q)})),Y=n.loaded?function(e,t,n,r,o){var l=t.page,c=t.perPage;return n.length>0?n.sort((function(t,n){return function(e,t){var n,r,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"title",a=function(e){return"appName"===o&&e.apiName?"apiName":o};return(arguments.length>3?arguments[3]:void 0)?null===(n=t[a(t)])||void 0===n?void 0:n.localeCompare(e[a(e)],"en",{sensitivity:"base"}):null===(r=e[a(e)])||void 0===r?void 0:r.localeCompare(t[a(t)],"en",{sensitivity:"base"})}(t,n,x[e.index],e.direction===O.SortByDirection.desc)})).slice((l-1)*c,l*c).map((function(e,t){var n,l=e.frontend,c=e.title,s=e.appName,u=e.version,p=e.apiName,f=e.api;return[F(F(F({},z(c,"".concat(f.subItems?"parent-":"").concat(p||s),f.versions,r,p||s)),f.subItems&&{isTreeOpen:null==o||null===(n=o.includes)||void 0===n?void 0:n.call(o,l&&l.title||c),subItems:f.subItems}),{},{noDetail:!u})].concat((0,a.Z)(f.subItems?Object.entries(f.subItems).map((function(e){var n=(0,i.Z)(e,2),o=n[0],a=n[1],l=a.title,c=a.versions,s=a.apiName;return F(F({},z(l,s||o,c,r,s||o)),{},{treeParent:t})})):[]))})).flat():J}(T,H,X||n.endpoints,n.selectedRows,j):[];return c().createElement(c().Fragment,null,c().createElement(p.Z,{className:"pf-m-light"},c().createElement(f.Z,{title:"API documentation"})),c().createElement(d.Z,{className:"ins-c-docs__api"},c().createElement(c().Fragment,null,c().createElement(g.Z,(0,r.Z)({filterConfig:{items:[{label:"Filter by application name",type:"text",filterValues:{id:"filter-by-string",key:"filter-by-string",placeholder:"Filter by application name",value:Q,onChange:function(e,t){q(G(G({},H),{},{page:1})),U(t)},isDisabled:!n.loaded}}]},actionsConfig:{actions:[{label:"Download selected",props:{isDisabled:(u=n,w=u.selectedRows,!w||0===Object.values(w||{}).map((function(e){return e.isSelected})).filter(Boolean).length),onClick:function(){return function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,n=new(I()),r=Object.values(e).filter((function(e){return e.isSelected})).map((function(e){var n=e.appName,r=e.version,o=e.apiName,a=e.subItems;return a?Object.entries(a).map((function(e){var n=(0,i.Z)(e,2),r=n[0],o=n[1].versions;return(0,N.w0)({name:r,version:o[0]}).catch((function(){return t("API ".concat(r," with version ").concat(o[0]," not found or broken."))}))})):(0,N.w0)({name:o||n,version:r}).catch((function(){return t("API ".concat(o||n," with version ").concat(r," not found or broken."))}))}));Promise.all(A()(r)).then((function(e){if(e&&e.length>1)e.map((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.name,r=(0,E.Z)(e,B);t&&(delete r.latest,n.file("".concat(t,"-openapi.json"),JSON.stringify(r)))})),n.generateAsync({type:"blob"}).then((function(e){return D()(e,"cloud-services-openapi.zip")}));else if(e&&1===e.length){var t=e[0]||{},r=t.name,o=(0,E.Z)(t,R);r&&(delete o.latest,D()(JSON.stringify(o),"".concat(r,"-openapi.json")))}}))}(n.selectedRows,s)}}}]}},n.loaded&&{pagination:G(G({},H),{},{itemCount:(X||n.endpoints).length,onSetPage:function(e,t){return q(G(G({},H),{},{page:t}))},onPerPageSelect:function(e,t){return q(G(G({},H),{},{perPage:t}))}})},Q.length>0&&{activeFiltersConfig:{filters:[{name:Q}],onDelete:function(){q(G(G({},H),{},{page:1})),U("")}}})),n.loaded?c().createElement(O.Table,(0,r.Z)({className:"pf-m-expandable pf-c-treeview","aria-label":"Sortable Table",variant:O.TableVariant.compact,sortBy:T,onSort:function(e,t,n){return L({index:t,direction:n})},cells:W((function(e,t){var n=t.props.value;j.includes(n)?Z((function(){return j.filter((function(e){return e!==n}))})):Z((function(){return[].concat((0,a.Z)(j),[n])}))})),rows:(0,b.t)(Y),rowWrapper:h.Z},(X||n.endpoints).length>0&&{onSelect:function(e,t,n){o(t,-1===n?Y:Y[n])}}),c().createElement(O.TableHeader,null),c().createElement(O.TableBody,null)):c().createElement(m.Z,{columns:W,rowSize:28})),c().createElement(v.Z,{isFooter:!0},n.loaded?c().createElement(y.Pagination,{variant:"bottom",dropDirection:"up",itemCount:(X||n.endpoints).length,perPage:H.perPage,page:H.page,onSetPage:function(e,t){return q(G(G({},H),{},{page:t}))},onPerPageSelect:function(e,t){return q(G(G({},H),{},{perPage:t}))}}):"loading")))};K.propTypes={loadApis:u().func,onError:u().func,services:u().shape({loaded:u().bool,selectedRows:u().shape({isSelected:u().bool}),endpoints:u().arrayOf(u().shape((0,o.Z)({},u().string,u().oneOfType([u().string,u().number,u().bool,u().node]))))}),history:u().shape({push:u().func}),selectRow:u().func},K.defaultProps={loadApis:function(){},selectRow:function(){},onError:function(){},services:{loaded:!1,selectedRows:{}}};const M=(0,w.connect)((function(e){return{services:e.services}}),(function(e){return{loadApis:function(){return e((0,P.j3)())},selectRow:function(t,n){return e((0,P.wS)({isSelected:t,row:n}))},onError:function(t){return e((0,H.wN)({variant:"danger",title:"Server error",description:t,dismissable:!0}))}}}))(K)}}]);
//# sourceMappingURL=../sourcemaps/Overview.c7741843c34979ee633f50b905ce541d.js.map